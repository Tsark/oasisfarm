# OasisFarm Events v2 Configuration

# A list of all available events that farms can use.
events:
  blood_moon:
    # Conditions to start the event.
    trigger:
      # This is an "AND" group. ALL conditions inside must be true.
      # You can also use 'mode: OR' to make it so ANY condition can be true.
      mode: AND
      conditions:
        - type: PLAYER_COUNT_IN_FARM
          value: '>= 1' # Supports operators: ==, !=, >, <, >=, <=
        - type: TIME_OF_DAY
          value: 'NIGHT'
        - type: TOTAL_KILLS_IN_FARM
          value: '>= 25' # Event triggers after 25 total kills in the farm

    # The sequence of phases for this event.
    phases:
      - phase_id: wave_one
        # Actions to execute when this phase begins.
        actions:
          - type: BROADCAST
            message: "&cThe moon bleeds! The first wave of undead approaches..."
          - type: SET_SPAWN_RATES # Override the farm's default spawns
            mobs:
              starter_zombie: 0.5 # 50% chance
              starter_skeleton: 0.5 # 50% chance

        # Conditions to advance to the next phase.
        progression:
          mode: OR # The phase ends if ANY of these are met.
          conditions:
            - type: DURATION
              value: '300s' # Phase ends after 5 minutes
            - type: MOB_KILLS_IN_FARM # Phase ends after players kill 20 zombies
              mob_id: 'starter_zombie'
              value: '>= 20'

      - phase_id: boss_spawn
        actions:
          - type: BROADCAST
            message: "&4&lThe ground trembles as the Skeletal King rises!"
          - type: CLEAR_MOBS # Clear out the remaining wave one mobs
          - type: SPAWN_ONCE # Spawn a single boss mob
            mobs:
              # You would need to create a 'skeletal_king' mob in mob-templates.yml for this to work
              - mob_id: 'skeletal_minion'
                amount: 1
          - type: SET_SPAWN_RATES
            mobs: {} # An empty mob list stops all natural spawning

        progression:
          mode: AND # Both conditions must be met to end the event
          conditions:
            - type: MOB_KILLS_IN_FARM
              mob_id: 'skeletal_minion'
              value: '>= 1' # The boss has been killed
            - type: DURATION
              value: '<= 600s' # And it was killed within 10 minutes

      - phase_id: event_success
        actions:
          - type: BROADCAST
            message: "&a&lVICTORY! The Blood Moon recedes, and the farm is safe once more."
          - type: COMMAND
            command: "eco give @a[distance=..100] 1000" # Give all players within 100 blocks $1000
        progression:
          conditions:
            - type: DURATION
              value: '10s' # The event ends 10 seconds after this phase starts.